FILE
  MLPolyRLetExpImpl(LET_EXP)
    PsiElement(KW_LET)('let')
    PsiWhiteSpace(' ')
    MLPolyRDefImpl(DEF)
      PsiElement(KW_FUN)('fun')
      PsiWhiteSpace(' ')
      MLPolyRFunctionImpl(FUNCTION)
        MLPolyRNamePatImpl(NAME_PAT)
          PsiElement(ID)('straighten')
        PsiWhiteSpace(' ')
        MLPolyRNamePatImpl(NAME_PAT)
          PsiElement(ID)('e')
        PsiWhiteSpace(' ')
        PsiElement(EQ)('=')
        PsiWhiteSpace('\n    ')
        MLPolyRLetExpImpl(LET_EXP)
          PsiElement(KW_LET)('let')
          PsiWhiteSpace(' ')
          MLPolyRDefImpl(DEF)
            PsiElement(KW_FUN)('fun')
            PsiWhiteSpace(' ')
            MLPolyRFunctionImpl(FUNCTION)
              MLPolyRNamePatImpl(NAME_PAT)
                PsiElement(ID)('build')
              PsiWhiteSpace(' ')
              MLPolyRListPatImpl(LIST_PAT)
                PsiElement(LP)('(')
                MLPolyRNamePatImpl(NAME_PAT)
                  PsiElement(ID)('wl')
                PsiElement(COMMA)(',')
                PsiWhiteSpace(' ')
                MLPolyRNamePatImpl(NAME_PAT)
                  PsiElement(ID)('e')
                PsiElement(RP)(')')
              PsiWhiteSpace(' ')
              PsiElement(EQ)('=')
              PsiWhiteSpace('\n        ')
              MLPolyRCaseExpImpl(CASE_EXP)
                PsiElement(KW_CASE)('case')
                PsiWhiteSpace(' ')
                MLPolyRAtomicExpImpl(ATOMIC_EXP)
                  MLPolyRIdentifierImpl(IDENTIFIER)
                    PsiElement(ID)('wl')
                PsiWhiteSpace(' ')
                PsiElement(KW_OF)('of')
                PsiWhiteSpace('\n            ')
                MLPolyRDtMatchImpl(DT_MATCH)
                  PsiElement(LSB)('[')
                  PsiElement(RSB)(']')
                  PsiWhiteSpace(' ')
                  PsiElement(DARROW)('=>')
                  PsiWhiteSpace(' ')
                  MLPolyRAtomicExpImpl(ATOMIC_EXP)
                    MLPolyRIdentifierImpl(IDENTIFIER)
                      PsiElement(ID)('e')
                  PsiWhiteSpace('\n          ')
                  PsiElement(BAR)('|')
                  PsiWhiteSpace(' ')
                  MLPolyRNamePatImpl(NAME_PAT)
                    PsiElement(ID)('h')
                  PsiWhiteSpace(' ')
                  PsiElement(DCOLON)('::')
                  PsiWhiteSpace(' ')
                  MLPolyRNamePatImpl(NAME_PAT)
                    PsiElement(ID)('t')
                  PsiWhiteSpace(' ')
                  PsiElement(DARROW)('=>')
                  PsiWhiteSpace('\n              ')
                  MLPolyRMatchExpImpl(MATCH_EXP)
                    PsiElement(KW_MATCH)('match')
                    PsiWhiteSpace(' ')
                    MLPolyRAtomicExpImpl(ATOMIC_EXP)
                      MLPolyRIdentifierImpl(IDENTIFIER)
                        PsiElement(ID)('h')
                    PsiWhiteSpace(' ')
                    PsiElement(KW_WITH)('with')
                    PsiWhiteSpace('\n                        ')
                    MLPolyRCasesExpImpl(CASES_EXP)
                      PsiElement(KW_CASES)('cases')
                      PsiWhiteSpace(' ')
                      MLPolyRMrImpl(MR)
                        PsiElement(BQ)('`')
                        MLPolyRLabelImpl(LABEL)
                          PsiElement(ID)('Num')
                        PsiWhiteSpace(' ')
                        MLPolyRNamePatImpl(NAME_PAT)
                          PsiElement(ID)('i')
                        PsiWhiteSpace(' ')
                        PsiElement(DARROW)('=>')
                        PsiWhiteSpace(' ')
                        MLPolyRAppExpImpl(APP_EXP)
                          MLPolyRAtomicExpImpl(ATOMIC_EXP)
                            MLPolyRIdentifierImpl(IDENTIFIER)
                              PsiElement(ID)('build')
                          PsiWhiteSpace(' ')
                          MLPolyRAtomicExpImpl(ATOMIC_EXP)
                            PsiElement(LP)('(')
                            MLPolyRAtomicExpImpl(ATOMIC_EXP)
                              MLPolyRIdentifierImpl(IDENTIFIER)
                                PsiElement(ID)('t')
                            PsiElement(COMMA)(',')
                            PsiWhiteSpace(' ')
                            MLPolyRPrefixExpImpl(PREFIX_EXP)
                              MLPolyRConImpl(CON)
                                PsiElement(BQ)('`')
                                MLPolyRLabelImpl(LABEL)
                                  PsiElement(ID)('Plus')
                              PsiWhiteSpace(' ')
                              MLPolyRAtomicExpImpl(ATOMIC_EXP)
                                PsiElement(LP)('(')
                                MLPolyRPrefixExpImpl(PREFIX_EXP)
                                  MLPolyRConImpl(CON)
                                    PsiElement(BQ)('`')
                                    MLPolyRLabelImpl(LABEL)
                                      PsiElement(ID)('Num')
                                  PsiWhiteSpace(' ')
                                  MLPolyRAtomicExpImpl(ATOMIC_EXP)
                                    MLPolyRIdentifierImpl(IDENTIFIER)
                                      PsiElement(ID)('i')
                                PsiElement(COMMA)(',')
                                PsiWhiteSpace(' ')
                                MLPolyRAtomicExpImpl(ATOMIC_EXP)
                                  MLPolyRIdentifierImpl(IDENTIFIER)
                                    PsiElement(ID)('e')
                                PsiElement(RP)(')')
                            PsiElement(RP)(')')
                      PsiWhiteSpace('\n                            ')
                      PsiElement(BAR)('|')
                      PsiWhiteSpace(' ')
                      MLPolyRMrImpl(MR)
                        PsiElement(BQ)('`')
                        MLPolyRLabelImpl(LABEL)
                          PsiElement(ID)('Plus')
                        PsiWhiteSpace(' ')
                        MLPolyRListPatImpl(LIST_PAT)
                          PsiElement(LP)('(')
                          MLPolyRNamePatImpl(NAME_PAT)
                            PsiElement(ID)('x')
                          PsiElement(COMMA)(',')
                          PsiWhiteSpace(' ')
                          MLPolyRNamePatImpl(NAME_PAT)
                            PsiElement(ID)('y')
                          PsiElement(RP)(')')
                        PsiWhiteSpace(' ')
                        PsiElement(DARROW)('=>')
                        PsiWhiteSpace(' ')
                        MLPolyRAppExpImpl(APP_EXP)
                          MLPolyRAtomicExpImpl(ATOMIC_EXP)
                            MLPolyRIdentifierImpl(IDENTIFIER)
                              PsiElement(ID)('build')
                          PsiWhiteSpace(' ')
                          MLPolyRAtomicExpImpl(ATOMIC_EXP)
                            PsiElement(LP)('(')
                            MLPolyRDColonExpImpl(D_COLON_EXP)
                              MLPolyRAtomicExpImpl(ATOMIC_EXP)
                                MLPolyRIdentifierImpl(IDENTIFIER)
                                  PsiElement(ID)('y')
                              PsiWhiteSpace(' ')
                              PsiElement(DCOLON)('::')
                              PsiWhiteSpace(' ')
                              MLPolyRDColonExpImpl(D_COLON_EXP)
                                MLPolyRAtomicExpImpl(ATOMIC_EXP)
                                  MLPolyRIdentifierImpl(IDENTIFIER)
                                    PsiElement(ID)('x')
                                PsiWhiteSpace(' ')
                                PsiElement(DCOLON)('::')
                                PsiWhiteSpace(' ')
                                MLPolyRAtomicExpImpl(ATOMIC_EXP)
                                  MLPolyRIdentifierImpl(IDENTIFIER)
                                    PsiElement(ID)('t')
                            PsiElement(COMMA)(',')
                            PsiWhiteSpace(' ')
                            MLPolyRAtomicExpImpl(ATOMIC_EXP)
                              MLPolyRIdentifierImpl(IDENTIFIER)
                                PsiElement(ID)('e')
                            PsiElement(RP)(')')
          PsiWhiteSpace('\n            ')
          MLPolyRDefImpl(DEF)
            PsiElement(KW_FUN)('fun')
            PsiWhiteSpace(' ')
            MLPolyRFunctionImpl(FUNCTION)
              MLPolyRNamePatImpl(NAME_PAT)
                PsiElement(ID)('start')
              PsiWhiteSpace(' ')
              MLPolyRListPatImpl(LIST_PAT)
                PsiElement(LP)('(')
                MLPolyRNamePatImpl(NAME_PAT)
                  PsiElement(ID)('e')
                PsiElement(COMMA)(',')
                PsiWhiteSpace(' ')
                MLPolyRNamePatImpl(NAME_PAT)
                  PsiElement(ID)('wl')
                PsiElement(RP)(')')
              PsiWhiteSpace(' ')
              PsiElement(EQ)('=')
              PsiWhiteSpace('\n        ')
              MLPolyRMatchExpImpl(MATCH_EXP)
                PsiElement(KW_MATCH)('match')
                PsiWhiteSpace(' ')
                MLPolyRAtomicExpImpl(ATOMIC_EXP)
                  MLPolyRIdentifierImpl(IDENTIFIER)
                    PsiElement(ID)('e')
                PsiWhiteSpace(' ')
                PsiElement(KW_WITH)('with')
                PsiWhiteSpace('\n                  ')
                MLPolyRCasesExpImpl(CASES_EXP)
                  PsiElement(KW_CASES)('cases')
                  PsiWhiteSpace(' ')
                  MLPolyRMrImpl(MR)
                    PsiElement(BQ)('`')
                    MLPolyRLabelImpl(LABEL)
                      PsiElement(ID)('Num')
                    PsiWhiteSpace(' ')
                    MLPolyRNamePatImpl(NAME_PAT)
                      PsiElement(ID)('i')
                    PsiWhiteSpace(' ')
                    PsiElement(DARROW)('=>')
                    PsiWhiteSpace(' ')
                    MLPolyRAppExpImpl(APP_EXP)
                      MLPolyRAtomicExpImpl(ATOMIC_EXP)
                        MLPolyRIdentifierImpl(IDENTIFIER)
                          PsiElement(ID)('build')
                      PsiWhiteSpace(' ')
                      MLPolyRAtomicExpImpl(ATOMIC_EXP)
                        PsiElement(LP)('(')
                        MLPolyRAtomicExpImpl(ATOMIC_EXP)
                          MLPolyRIdentifierImpl(IDENTIFIER)
                            PsiElement(ID)('wl')
                        PsiElement(COMMA)(',')
                        PsiWhiteSpace(' ')
                        MLPolyRPrefixExpImpl(PREFIX_EXP)
                          MLPolyRConImpl(CON)
                            PsiElement(BQ)('`')
                            MLPolyRLabelImpl(LABEL)
                              PsiElement(ID)('Num')
                          PsiWhiteSpace(' ')
                          MLPolyRAtomicExpImpl(ATOMIC_EXP)
                            MLPolyRIdentifierImpl(IDENTIFIER)
                              PsiElement(ID)('i')
                        PsiElement(RP)(')')
                  PsiWhiteSpace('\n                      ')
                  PsiElement(BAR)('|')
                  PsiWhiteSpace(' ')
                  MLPolyRMrImpl(MR)
                    PsiElement(BQ)('`')
                    MLPolyRLabelImpl(LABEL)
                      PsiElement(ID)('Plus')
                    PsiWhiteSpace(' ')
                    MLPolyRListPatImpl(LIST_PAT)
                      PsiElement(LP)('(')
                      MLPolyRNamePatImpl(NAME_PAT)
                        PsiElement(ID)('x')
                      PsiElement(COMMA)(',')
                      PsiWhiteSpace(' ')
                      MLPolyRNamePatImpl(NAME_PAT)
                        PsiElement(ID)('y')
                      PsiElement(RP)(')')
                    PsiWhiteSpace(' ')
                    PsiElement(DARROW)('=>')
                    PsiWhiteSpace(' ')
                    MLPolyRAppExpImpl(APP_EXP)
                      MLPolyRAtomicExpImpl(ATOMIC_EXP)
                        MLPolyRIdentifierImpl(IDENTIFIER)
                          PsiElement(ID)('start')
                      PsiWhiteSpace(' ')
                      MLPolyRAtomicExpImpl(ATOMIC_EXP)
                        PsiElement(LP)('(')
                        MLPolyRAtomicExpImpl(ATOMIC_EXP)
                          MLPolyRIdentifierImpl(IDENTIFIER)
                            PsiElement(ID)('y')
                        PsiElement(COMMA)(',')
                        PsiWhiteSpace(' ')
                        MLPolyRDColonExpImpl(D_COLON_EXP)
                          MLPolyRAtomicExpImpl(ATOMIC_EXP)
                            MLPolyRIdentifierImpl(IDENTIFIER)
                              PsiElement(ID)('x')
                          PsiWhiteSpace(' ')
                          PsiElement(DCOLON)('::')
                          PsiWhiteSpace(' ')
                          MLPolyRAtomicExpImpl(ATOMIC_EXP)
                            MLPolyRIdentifierImpl(IDENTIFIER)
                              PsiElement(ID)('wl')
                        PsiElement(RP)(')')
          PsiWhiteSpace('\n    ')
          PsiElement(KW_IN)('in')
          PsiWhiteSpace(' ')
          MLPolyRAppExpImpl(APP_EXP)
            MLPolyRAtomicExpImpl(ATOMIC_EXP)
              MLPolyRIdentifierImpl(IDENTIFIER)
                PsiElement(ID)('start')
            PsiWhiteSpace(' ')
            MLPolyRAtomicExpImpl(ATOMIC_EXP)
              PsiElement(LP)('(')
              MLPolyRAtomicExpImpl(ATOMIC_EXP)
                MLPolyRIdentifierImpl(IDENTIFIER)
                  PsiElement(ID)('e')
              PsiElement(COMMA)(',')
              PsiWhiteSpace(' ')
              MLPolyRAtomicExpImpl(ATOMIC_EXP)
                PsiElement(LSB)('[')
                PsiElement(RSB)(']')
              PsiElement(RP)(')')
          PsiWhiteSpace('\n    ')
          PsiElement(KW_END)('end')
    PsiWhiteSpace('\n\n    ')
    MLPolyRDefImpl(DEF)
      PsiElement(KW_FUN)('fun')
      PsiWhiteSpace(' ')
      MLPolyRFunctionImpl(FUNCTION)
        MLPolyRNamePatImpl(NAME_PAT)
          PsiElement(ID)('count')
        PsiWhiteSpace(' ')
        MLPolyRNamePatImpl(NAME_PAT)
          PsiElement(ID)('e')
        PsiWhiteSpace(' ')
        PsiElement(EQ)('=')
        PsiWhiteSpace('\n        ')
        MLPolyRLetExpImpl(LET_EXP)
          PsiElement(KW_LET)('let')
          PsiWhiteSpace(' ')
          MLPolyRDefImpl(DEF)
            PsiElement(KW_FUN)('fun')
            PsiWhiteSpace(' ')
            MLPolyRFunctionImpl(FUNCTION)
              MLPolyRNamePatImpl(NAME_PAT)
                PsiElement(ID)('isnum')
              PsiWhiteSpace(' ')
              MLPolyRNamePatImpl(NAME_PAT)
                PsiElement(ID)('e')
              PsiWhiteSpace(' ')
              PsiElement(EQ)('=')
              PsiWhiteSpace(' ')
              MLPolyRMatchExpImpl(MATCH_EXP)
                PsiElement(KW_MATCH)('match')
                PsiWhiteSpace(' ')
                MLPolyRAtomicExpImpl(ATOMIC_EXP)
                  MLPolyRIdentifierImpl(IDENTIFIER)
                    PsiElement(ID)('e')
                PsiWhiteSpace(' ')
                PsiElement(KW_WITH)('with')
                PsiWhiteSpace(' ')
                MLPolyRCasesExpImpl(CASES_EXP)
                  PsiElement(KW_CASES)('cases')
                  PsiWhiteSpace(' ')
                  MLPolyRMrImpl(MR)
                    PsiElement(BQ)('`')
                    MLPolyRLabelImpl(LABEL)
                      PsiElement(ID)('Num')
                    PsiWhiteSpace(' ')
                    MLPolyRWildPatImpl(WILD_PAT)
                      PsiElement(WILD)('_')
                    PsiWhiteSpace(' ')
                    PsiElement(DARROW)('=>')
                    PsiWhiteSpace(' ')
                    MLPolyRAtomicExpImpl(ATOMIC_EXP)
                      PsiElement(INT)('1')
          PsiWhiteSpace('\n    ')
          PsiElement(KW_IN)('in')
          PsiWhiteSpace(' ')
          MLPolyRMatchExpImpl(MATCH_EXP)
            PsiElement(KW_MATCH)('match')
            PsiWhiteSpace(' ')
            MLPolyRAtomicExpImpl(ATOMIC_EXP)
              MLPolyRIdentifierImpl(IDENTIFIER)
                PsiElement(ID)('e')
            PsiWhiteSpace(' ')
            PsiElement(KW_WITH)('with')
            PsiWhiteSpace('\n             ')
            MLPolyRCasesExpImpl(CASES_EXP)
              PsiElement(KW_CASES)('cases')
              PsiWhiteSpace(' ')
              MLPolyRMrImpl(MR)
                PsiElement(BQ)('`')
                MLPolyRLabelImpl(LABEL)
                  PsiElement(ID)('Num')
                PsiWhiteSpace(' ')
                MLPolyRNamePatImpl(NAME_PAT)
                  PsiElement(ID)('i')
                PsiWhiteSpace(' ')
                PsiElement(DARROW)('=>')
                PsiWhiteSpace(' ')
                MLPolyRAtomicExpImpl(ATOMIC_EXP)
                  PsiElement(INT)('1')
              PsiWhiteSpace('\n                 ')
              PsiElement(BAR)('|')
              PsiWhiteSpace(' ')
              MLPolyRMrImpl(MR)
                PsiElement(BQ)('`')
                MLPolyRLabelImpl(LABEL)
                  PsiElement(ID)('Plus')
                PsiWhiteSpace(' ')
                MLPolyRListPatImpl(LIST_PAT)
                  PsiElement(LP)('(')
                  MLPolyRNamePatImpl(NAME_PAT)
                    PsiElement(ID)('n')
                  PsiElement(COMMA)(',')
                  PsiWhiteSpace(' ')
                  MLPolyRNamePatImpl(NAME_PAT)
                    PsiElement(ID)('e')
                  PsiElement(RP)(')')
                PsiWhiteSpace(' ')
                PsiElement(DARROW)('=>')
                PsiWhiteSpace(' ')
                MLPolyRPlusExpImpl(PLUS_EXP)
                  MLPolyRAppExpImpl(APP_EXP)
                    MLPolyRAtomicExpImpl(ATOMIC_EXP)
                      MLPolyRIdentifierImpl(IDENTIFIER)
                        PsiElement(ID)('isnum')
                    PsiWhiteSpace(' ')
                    MLPolyRAtomicExpImpl(ATOMIC_EXP)
                      MLPolyRIdentifierImpl(IDENTIFIER)
                        PsiElement(ID)('n')
                  PsiWhiteSpace(' ')
                  PsiElement(PLUS)('+')
                  PsiWhiteSpace(' ')
                  MLPolyRAppExpImpl(APP_EXP)
                    MLPolyRAtomicExpImpl(ATOMIC_EXP)
                      MLPolyRIdentifierImpl(IDENTIFIER)
                        PsiElement(ID)('count')
                    PsiWhiteSpace(' ')
                    MLPolyRAtomicExpImpl(ATOMIC_EXP)
                      MLPolyRIdentifierImpl(IDENTIFIER)
                        PsiElement(ID)('e')
          PsiWhiteSpace('\n    ')
          PsiElement(KW_END)('end')
    PsiWhiteSpace('\n\n    ')
    MLPolyRDefImpl(DEF)
      PsiElement(KW_FUN)('fun')
      PsiWhiteSpace(' ')
      MLPolyRFunctionImpl(FUNCTION)
        MLPolyRNamePatImpl(NAME_PAT)
          PsiElement(ID)('foo')
        PsiWhiteSpace(' ')
        MLPolyRNamePatImpl(NAME_PAT)
          PsiElement(ID)('e')
        PsiWhiteSpace(' ')
        PsiElement(EQ)('=')
        PsiWhiteSpace(' ')
        MLPolyRAppExpImpl(APP_EXP)
          MLPolyRAtomicExpImpl(ATOMIC_EXP)
            MLPolyRIdentifierImpl(IDENTIFIER)
              PsiElement(ID)('count')
          PsiWhiteSpace(' ')
          MLPolyRAtomicExpImpl(ATOMIC_EXP)
            PsiElement(LP)('(')
            MLPolyRAppExpImpl(APP_EXP)
              MLPolyRAtomicExpImpl(ATOMIC_EXP)
                MLPolyRIdentifierImpl(IDENTIFIER)
                  PsiElement(ID)('straighten')
              PsiWhiteSpace(' ')
              MLPolyRAtomicExpImpl(ATOMIC_EXP)
                MLPolyRIdentifierImpl(IDENTIFIER)
                  PsiElement(ID)('e')
            PsiElement(RP)(')')
    PsiWhiteSpace('\n')
    PsiElement(KW_IN)('in')
    PsiWhiteSpace(' ')
    MLPolyRAtomicExpImpl(ATOMIC_EXP)
      PsiElement(INT)('0')
    PsiWhiteSpace('\n')
    PsiElement(KW_END)('end')